<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>游戏面板 - 星露谷风格</title>
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    <style>
        body { 
            margin: 0; padding: 0; background: #333; 
            font-family: 'ZCOOL KuaiLe', cursive; color: white;
            display: flex; flex-direction: column; align-items: center;
        }
        .status-bar { 
            margin: 20px 0; color: #ffcc00; font-size: 18px; 
            background: rgba(0,0,0,0.3); padding: 10px 20px; border-radius: 20px;
        }
        /* 手机端两列饱满布局 */
        .card-grid { 
            display: grid; grid-template-columns: 1fr 1fr; 
            gap: 15px; width: 95%; padding: 10px; box-sizing: border-box;
        }
        .card-box { 
            height: 65vw; min-height: 240px; perspective: 1000px; cursor: pointer;
        }
        .card-inner { 
            position: relative; width: 100%; height: 100%; 
            transition: transform 0.6s; transform-style: preserve-3d; 
        }
        .card-box.flipped .card-inner { transform: rotateY(180deg); }
        .face { 
            position: absolute; width: 100%; height: 100%; 
            backface-visibility: hidden; border-radius: 15px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 10px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        }
        /* 玩家背面颜色 */
        .p1 { background: #ff9a30; } .p2 { background: #970037; }
        .p3 { background: #FFF8E7; color: #5d3a1a !important; border: 3px solid #eb7a42; } .p4 { background: #481c17; }
        
        .card-front { 
            background: #fff8e7; color: #5d3a1a; transform: rotateY(180deg); 
            border: 4px solid #5d3a1a;
        }
        .main-text { font-size: 18px; line-height: 1.4; margin: 5px 0; }
        .label { font-size: 12px; color: #888; }
        .red { color: #e74c3c !important; }

        /* 木质洗牌按钮 */
        .shuffle-btn {
            margin: 30px 0; width: 80%; height: 60px;
            background: #e6b06e; border: 4px solid #5d3a1a;
            color: #5d3a1a; font-family: 'ZCOOL KuaiLe'; font-size: 22px;
            box-shadow: inset -3px -3px 0px #9d6d3d, inset 3px 3px 0px #f5d6a8;
        }
    </style>
</head>
<body>
    <div class="status-bar" id="status">正在加载房间...</div>
    <div class="card-grid" id="grid"></div>
    <button class="shuffle-btn" onclick="initGame()">重新洗牌</button>

    <script>
        const conditions = ["有人说“听牌”", "有人碰牌", "有人笑", "有人打出单数", "有人打九", "有人说“胡”", "有人打出筒", "全场安静三秒"];
        const punishments = ["扇自己巴掌", "闻自己脚", "喵一声", "喝一大口水", "大笑三声", "模仿猩猩", "做三个深蹲"];

        const params = new URLSearchParams(window.location.search);
        const room = params.get('room');
        const myRole = parseInt(params.get('role'));

        document.getElementById('status').innerText = `房间: ${room} | 你是玩家 ${myRole}`;

        function initGame() {
            const grid = document.getElementById('grid');
            grid.innerHTML = "";
            const s_c = [...conditions].sort(() => Math.random() - 0.5);
            const s_p = [...punishments].sort(() => Math.random() - 0.5);

            for (let i = 1; i <= 4; i++) {
                const isMine = i === myRole;
                const card = document.createElement('div');
                card.className = "card-box";
                card.onclick = function() {
                    if(!isMine) return alert("只能看你自己的牌！");
                    this.classList.toggle('flipped');
                };
                card.innerHTML = `
                    <div class="card-inner">
                        <div class="face p${i}">玩家 ${i}${isMine?' (你)':''}</div>
                        <div class="face card-front">
                            <div class="label">【不要做】</div>
                            <div class="main-text">${s_c[i]}</div>
                            <div style="width:50%;height:1px;background:#ddd;margin:10px 0;"></div>
                            <div class="label red">【否则惩罚】</div>
                            <div class="main-text red">${s_p[i]}</div>
                        </div>
                    </div>`;
                grid.appendChild(card);
            }
        }
        initGame();
    </script>
</body>
</html>
