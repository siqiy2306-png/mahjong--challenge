<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ€„ï¸ éº»å°†ä¸è¦åšæŒ‘æˆ˜ - æš—ç‰Œç‰ˆ</title>
    <style>
        :root {
            --bg-color: #1a4d33;
            --card-front: #f5f5f5;
            --card-back: #2c3e50;
            --accent: #ffcc00;
        }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            text-align: center; background: var(--bg-color); color: white; padding: 20px; margin: 0;
        }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 500px; margin: 0 auto; }
        .card { 
            background: var(--card-front); color: #333; border-radius: 12px; padding: 15px; 
            min-height: 160px; display: flex; flex-direction: column; justify-content: center;
            align-items: center; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.3); 
            transition: all 0.3s ease; position: relative; border: 2px solid transparent;
        }
        .card.hidden { background: var(--card-back); border: 2px solid var(--accent); }
        .card.hidden .content { opacity: 0; visibility: hidden; }
        .card.hidden::after { content: "ğŸ€„ ç‚¹å‡»ç¿»å¼€"; position: absolute; color: var(--accent); font-weight: bold; }
        .player-tag { font-size: 0.8rem; color: #888; margin-bottom: 10px; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
        .topic-label { font-weight: bold; color: #1a4d33; font-size: 0.9rem; }
        .punish-label { font-weight: bold; color: #c0392b; font-size: 0.9rem; margin-top: 10px; }
        .text-detail { font-size: 1.05rem; margin-top: 4px; line-height: 1.4; }
        button { 
            background: #e67e22; color: white; border: none; padding: 15px 40px; 
            font-size: 1.1rem; border-radius: 50px; cursor: pointer; 
            font-weight: bold; margin: 25px 0; box-shadow: 0 4px 0 #d35400;
        }
        #loading-status { font-size: 0.8rem; color: var(--accent); margin-bottom: 10px; }
    </style>
</head>
<body>
    <h1>éº»å°†ä¸è¦åšæŒ‘æˆ˜</h1>
    <div id="loading-status">æ­£åœ¨è¿æ¥é¢˜åº“...</div>
    <button onclick="shuffle()">é‡æ–°éšæœºå‘ç‰Œ</button>
    <div class="grid" id="gameBoard"></div>

    <script>
        let gameData = { conditions: [], punishments: [] };

        async function init() {
            const status = document.getElementById('loading-status');
            try {
                // é‡ç‚¹ï¼šä½¿ç”¨å½“å‰æ—¶é—´æˆ³å¼ºåˆ¶åˆ·æ–°ï¼Œç¡®ä¿ä¸è¯»æ—§ç¼“å­˜
                const res = await fetch('./data.json?t=' + Date.now());
                if (!res.ok) throw new Error('æ‰¾ä¸åˆ° data.json');
                const json = await res.json();
                
                // è‡ªåŠ¨è¯†åˆ«ä¸åŒçš„æ•°æ®å±‚çº§
                const d = json.data || json; 
                gameData.conditions = d.conditions || [];
                gameData.punishments = d.punishments || [];
                
                if (gameData.conditions.length === 0) throw new Error('é¢˜åº“é‡Œæ²¡ä¸œè¥¿');

                status.innerText = "âœ… é¢˜åº“åŒæ­¥æˆåŠŸï¼";
                shuffle();
            } catch (e) {
                status.innerText = "âŒ è¿˜æ˜¯å¤±è´¥äº†ï¼š" + e.message;
                console.error(e);
            }
        }

        function shuffle() {
            if (gameData.conditions.length < 4) return;
            const board = document.getElementById('gameBoard');
            board.innerHTML = "";
            let cList = [...gameData.conditions].sort(() => Math.random() - 0.5);
            let pList = [...gameData.punishments].sort(() => Math.random() - 0.5);

            for (let i = 1; i <= 4; i++) {
                const card = document.createElement('div');
                card.className = "card hidden";
                card.onclick = function() { this.classList.toggle('hidden'); };
                card.innerHTML = `
                    <div class="content">
                        <div class="player-tag">ç©å®¶ ${i}</div>
                        <div class="topic-label">è§¦å‘æ¡ä»¶ï¼š</div>
                        <div class="text-detail">${cList[i-1]}</div>
                        <div class="punish-label">è¢«åˆ¶è£åï¼š</div>
                        <div class="text-detail">${pList[i-1]}</div>
                    </div>`;
                board.appendChild(card);
            }
        }
        init();
    </script>
</body>
</html>
